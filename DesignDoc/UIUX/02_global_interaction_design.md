# 全局导航与交互逻辑设计

## 底部导航栏设计

### 基础样式
- **高度**：56dp
- **宽度**：全屏宽
- **背景色**：白色（#FFFFFF）
- **阴影**：顶部轻微阴影（elevation: 8dp）
- **布局**：均分四个导航项

### 导航项设计
1. **体测**
   - 图标：体重计/身体轮廓图标
   - 文字：体测（12sp，Roboto Medium）
   - 状态：
     - 选中：图标和文字为主色调（#1E88E5）
     - 未选中：图标和文字为灰色（#757575）

2. **训练**
   - 图标：哑铃/健身图标
   - 文字：训练（12sp，Roboto Medium）
   - 状态：同上

3. **饮食**
   - 图标：餐盘/食物图标
   - 文字：饮食（12sp，Roboto Medium）
   - 状态：同上

4. **资源**
   - 图标：书籍/文档图标
   - 文字：资源（12sp，Roboto Medium）
   - 状态：同上

### 交互效果
- **点击反馈**：
  - 轻微波纹效果（Material Design ripple）
  - 图标轻微放大再恢复的弹性动画
  - 颜色从灰色平滑过渡到主色调

- **页面切换动画**：
  - 水平滑动切换：当前页面向左/右滑出，新页面从相反方向滑入
  - 动画持续时间：300ms
  - 缓动函数：标准减速曲线

- **指示器**：
  - 选中项下方显示小型横条指示器（宽度为图标宽度，高度2dp）
  - 指示器颜色：主色调（#1E88E5）
  - 切换时平滑滑动到新位置

### 特殊状态
- **隐藏状态**：
  - 在全屏阅读模式下自动隐藏（向下滑出屏幕）
  - 轻触屏幕底部区域可重新显示
  
- **禁用状态**：
  - 数据录入过程中临时禁用导航切换
  - 禁用项显示为浅灰色

## 弹框设计规范

### 通用弹框样式
- **背景**：白色（#FFFFFF）
- **圆角**：12dp统一圆角
- **阴影**：中等阴影（elevation: 24dp）
- **边距**：内边距16dp
- **宽度**：屏幕宽度的85%
- **高度**：自适应内容，最大为屏幕高度的70%
- **遮罩层**：半透明黑色（透明度60%）

### 弹框类型

1. **确认弹框**
   - **用途**：需要用户确认的简单操作
   - **组件**：
     - 标题（18sp，黑色，Roboto Medium）
     - 内容文字（16sp，灰色，Roboto Regular）
     - 取消按钮（文字按钮，灰色）
     - 确认按钮（文字按钮，主色调）
   - **布局**：
     - 标题居中或左对齐
     - 按钮水平排列在底部右侧

2. **输入弹框**
   - **用途**：简单数据录入（如体重）
   - **组件**：
     - 标题（18sp，黑色，Roboto Medium）
     - 输入字段（带标签和提示文字）
     - 辅助文字/错误提示（12sp，红色/灰色）
     - 取消按钮（文字按钮，灰色）
     - 确认按钮（文字按钮，主色调）
   - **布局**：
     - 输入字段占据主要空间
     - 按钮水平排列在底部右侧

3. **选择弹框**
   - **用途**：从预设选项中选择（如训练类型）
   - **组件**：
     - 标题（18sp，黑色，Roboto Medium）
     - 选项列表（单选/多选）
     - 取消按钮（文字按钮，灰色）
     - 确认按钮（文字按钮，主色调）
   - **布局**：
     - 选项垂直排列
     - 每个选项高度56dp
     - 选中项显示勾选图标或背景高亮

### 弹框交互逻辑

- **显示动画**：
  - 从屏幕中心轻微放大显示
  - 同时背景遮罩淡入
  - 动画持续时间：200ms

- **关闭方式**：
  - 点击确认/取消按钮
  - 点击遮罩区域（可选，部分弹框禁用）
  - 按返回键

- **关闭动画**：
  - 轻微缩小并淡出
  - 同时背景遮罩淡出
  - 动画持续时间：150ms

- **键盘交互**：
  - 输入弹框显示时自动弹出键盘
  - 点击输入框外区域收起键盘
  - 支持回车键确认输入

## 底部抽屉设计规范

### 通用抽屉样式
- **背景**：白色（#FFFFFF）
- **圆角**：顶部左右圆角16dp
- **阴影**：顶部阴影（elevation: 16dp）
- **内边距**：水平16dp，顶部24dp，底部16dp
- **宽度**：全屏宽
- **高度**：可变，最小为屏幕高度的40%，最大为屏幕高度的90%
- **遮罩层**：半透明黑色（透明度40%）

### 抽屉组件

1. **拖动指示器**
   - **样式**：水平灰色条形（宽32dp，高4dp，圆角2dp）
   - **位置**：顶部中央，距顶部8dp
   - **功能**：提示用户可拖动

2. **标题区域**
   - **样式**：标题文字（18sp，黑色，Roboto Medium）+ 关闭按钮
   - **位置**：拖动指示器下方16dp
   - **功能**：说明抽屉用途，提供关闭入口

3. **内容区域**
   - **样式**：根据具体用途变化
   - **位置**：标题区域下方
   - **功能**：展示主要内容和交互元素

4. **操作按钮区域**
   - **样式**：主要操作按钮（圆角矩形，主色调背景）+ 次要操作按钮
   - **位置**：内容区域下方，距底部16dp
   - **功能**：提供确认/取消等操作

### 抽屉类型

1. **列表抽屉**
   - **用途**：显示选项列表（如训练模板选择）
   - **内容**：
     - 可选搜索栏
     - 垂直选项列表
     - 分类标签（可选）
   - **交互**：
     - 点击选项：选中/取消选中
     - 滚动浏览更多选项

2. **表单抽屉**
   - **用途**：复杂数据录入（如食物详情）
   - **内容**：
     - 多个输入字段
     - 选择器（如数量、单位）
     - 提交按钮
   - **交互**：
     - 字段间Tab键切换
     - 表单验证与错误提示

3. **详情抽屉**
   - **用途**：显示详细信息（如训练历史详情）
   - **内容**：
     - 详情字段
     - 图表/数据可视化
     - 操作按钮（如编辑/删除）
   - **交互**：
     - 滚动查看更多内容
     - 点击操作按钮执行相应功能

4. **操作抽屉**
   - **用途**：提供功能操作界面（如训练计时）
   - **内容**：
     - 操作控件（如计时器、计数器）
     - 状态显示
     - 控制按钮
   - **交互**：
     - 实时响应用户操作
     - 状态变化时提供视觉/触觉反馈

### 抽屉交互逻辑

- **显示动画**：
  - 从屏幕底部向上滑入
  - 同时背景遮罩淡入
  - 动画持续时间：250ms
  - 缓动函数：减速曲线

- **高度调整**：
  - 支持拖动调整高度
  - 拖动超过阈值自动展开/收起
  - 展开/收起时有平滑动画

- **关闭方式**：
  - 向下滑动（需超过阈值）
  - 点击关闭按钮或完成按钮
  - 点击遮罩区域（可选，部分抽屉禁用）
  - 按返回键

- **关闭动画**：
  - 向下滑出屏幕
  - 同时背景遮罩淡出
  - 动画持续时间：200ms
  - 缓动函数：加速曲线

## 全局交互流程

### 页面切换流程

1. **底部导航切换**
   - 用户点击底部导航项
   - 当前页面水平滑出，新页面水平滑入
   - Dashboard卡片从展开状态收起或保持收起状态
   - 新页面内容加载完成后启用交互

2. **Dashboard切换**
   - 用户点击收起状态的Dashboard卡片
   - 当前页面下移，Dashboard展开
   - 底部导航栏高亮切换到首页项
   - 展开动画：垂直滑动+轻微缩放

3. **返回操作**
   - 用户按返回键或使用系统返回手势
   - 如在子页面：返回上一级页面
   - 如在弹框/抽屉：关闭弹框/抽屉
   - 如在主页面：询问是否退出应用

### 数据录入流程

1. **快速录入**
   - 触发：点击相关快速录入按钮
   - 直接添加预设数据（如+100kcal）
   - 显示简短成功提示
   - 相关数据立即更新

2. **简单录入**
   - 触发：点击相关添加按钮
   - 显示输入弹框
   - 用户输入数据并确认
   - 数据验证通过后添加
   - 相关卡片和统计数据更新

3. **复杂录入**
   - 触发：点击FAB或详细添加按钮
   - 打开底部抽屉表单
   - 用户填写多个字段
   - 提交前进行表单验证
   - 提交成功后关闭抽屉
   - 相关页面数据更新

### 通用交互模式

1. **列表操作**
   - 左滑：显示删除按钮
   - 右滑：显示编辑/完成按钮（根据上下文）
   - 长按：进入多选模式或显示操作菜单
   - 点击：查看详情或执行主要操作

2. **图表交互**
   - 点击数据点：显示详细数值
   - 长按：显示十字准线和详细信息
   - 左右滑动：查看更多历史数据
   - 双指缩放：调整数据范围

3. **表单交互**
   - 字段获取焦点时轻微放大
   - 错误状态：红色下划线+错误提示
   - 成功状态：绿色勾选图标
   - 必填字段标记：标签带星号(*)

## 特殊交互场景

### 1. 首次使用引导
- **触发**：首次安装后启动应用
- **流程**：
  - 欢迎页面：应用介绍和主要功能
  - 权限请求：解释所需权限及用途
  - 个人资料设置：引导用户设置基本信息
  - 功能引导：核心功能的简短教程
  - 完成设置：进入主界面，显示成功提示

### 2. 数据同步状态
- **触发**：数据变更或手动同步
- **流程**：
  - 同步中：顶部显示同步指示器
  - 同步成功：显示简短成功提示
  - 同步失败：显示错误提示和重试选项
  - 离线模式：显示离线标识，数据本地保存

### 3. 成就解锁
- **触发**：达成特定目标（如连续打卡7天）
- **流程**：
  - 解锁动画：成就卡片从底部滑入
  - 显示成就名称和图标
  - 提供分享选项
  - 用户确认后添加到成就列表

### 4. 提醒通知
- **触发**：设定的训练/饮食提醒时间到达
- **流程**：
  - 系统通知：显示提醒内容和时间
  - 点击通知：直接进入相关页面
  - 操作按钮：直接在通知中完成/推迟
  - 完成后：更新应用内相关状态

## 错误处理与反馈

### 1. 错误状态
- **网络错误**：
  - 显示离线提示
  - 提供重试按钮
  - 确保本地数据可用

- **数据错误**：
  - 显示具体错误原因
  - 提供修复建议
  - 防止错误数据保存

- **系统错误**：
  - 显示友好错误信息
  - 提供报告问题选项
  - 尝试恢复到安全状态

### 2. 反馈机制
- **操作成功**：
  - 轻量级Toast提示（2秒）
  - 成功图标+简短文字
  - 位置：屏幕底部

- **操作失败**：
  - 警告提示（可点击关闭）
  - 错误图标+原因说明
  - 位置：屏幕顶部

- **进行中状态**：
  - 进度指示器（环形或线性）
  - 操作描述文字
  - 长时间操作显示取消选项

### 3. 触觉反馈
- **按钮点击**：轻微振动（15ms）
- **错误操作**：错误振动模式（双振动）
- **完成操作**：成功振动模式（单长振动）
- **计时结束**：强振动提醒（3次短振动）

## 无障碍设计考虑

### 1. 屏幕阅读器支持
- 所有交互元素提供内容描述
- 图表提供替代文本描述
- 弹框/抽屉打开时焦点自动移至首个交互元素

### 2. 操作便利性
- 触摸目标最小尺寸48dp x 48dp
- 相关操作分组放置
- 提供键盘导航支持
- 支持系统字体大小调整

### 3. 视觉辅助
- 颜色对比度符合WCAG 2.0 AA标准
- 不仅依靠颜色传达信息（配合图标和文字）
- 支持高对比度模式
- 动画可在系统设置中关闭
